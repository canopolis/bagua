<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lo Pan Bagua Feng Shui Map</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            width: 100%;
            text-align: center;
        }

        h1 {
            color: #8B4513;
            margin-bottom: 20px;
        }

        .compass-container {
            position: relative;
            width: 500px;
            height: 500px;
            margin: 0 auto 30px;
        }

        .bagua-map {
            position: absolute;
            width: 100%;
            height: 100%;
            transition: transform 0.3s ease;
        }

        .center-arrow {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 40px solid white;
            z-index: 10;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .compass-info {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .sector-info {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: left;
            margin-top: 20px;
        }

        .sector-info h2 {
            color: #8B4513;
            margin-top: 0;
        }

        .cure-list {
            list-style-type: disc;
            padding-left: 20px;
        }

        .error {
            color: #d32f2f;
            padding: 10px;
            background: #ffebee;
            border-radius: 4px;
            margin: 10px 0;
        }

        .loading {
            color: #666;
        }

        @media (max-width: 600px) {
            .compass-container {
                width: 350px;
                height: 350px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Lo Pan Bagua Feng Shui Map</h1>
        
        <div class="compass-info">
            <p class="loading" id="status">Initializing compass...</p>
            <p><strong>Compass Direction:</strong> <span id="compass-reading">--</span>Â°</p>
            <p><strong>Facing Direction:</strong> <span id="facing-direction">--</span></p>
        </div>

        <div class="compass-container">
            <svg class="bagua-map" id="bagua" viewBox="0 0 500 500">
                <!-- Outer octagon background -->
                <polygon points="150,50 350,50 450,150 450,350 350,450 150,450 50,350 50,150" 
                         fill="#8B4513" stroke="#654321" stroke-width="3"/>
                
                <!-- North -->
                <path d="M 250,250 L 150,50 L 350,50 Z" fill="#4FC3F7" stroke="#333" stroke-width="2" class="sector" data-sector="north"/>
                <text x="250" y="100" text-anchor="middle" font-size="24" font-weight="bold" fill="white">North</text>
                
                <!-- Northeast -->
                <path d="M 250,250 L 350,50 L 450,150 Z" fill="#FFF176" stroke="#333" stroke-width="2" class="sector" data-sector="northeast"/>
                <text x="375" y="125" text-anchor="middle" font-size="18" font-weight="bold" fill="#333" transform="rotate(45 375 125)">Northeast</text>
                
                <!-- East -->
                <path d="M 250,250 L 450,150 L 450,350 Z" fill="#81C784" stroke="#333" stroke-width="2" class="sector" data-sector="east"/>
                <text x="400" y="250" text-anchor="middle" font-size="24" font-weight="bold" fill="white">East</text>
                
                <!-- Southeast -->
                <path d="M 250,250 L 450,350 L 350,450 Z" fill="#AED581" stroke="#333" stroke-width="2" class="sector" data-sector="southeast"/>
                <text x="375" y="375" text-anchor="middle" font-size="18" font-weight="bold" fill="#333" transform="rotate(-45 375 375)">Southeast</text>
                
                <!-- South -->
                <path d="M 250,250 L 350,450 L 150,450 Z" fill="#E57373" stroke="#333" stroke-width="2" class="sector" data-sector="south"/>
                <text x="250" y="400" text-anchor="middle" font-size="24" font-weight="bold" fill="white">South</text>
                
                <!-- Southwest -->
                <path d="M 250,250 L 150,450 L 50,350 Z" fill="#FFB74D" stroke="#333" stroke-width="2" class="sector" data-sector="southwest"/>
                <text x="125" y="375" text-anchor="middle" font-size="18" font-weight="bold" fill="#333" transform="rotate(45 125 375)">Southwest</text>
                
                <!-- West -->
                <path d="M 250,250 L 50,350 L 50,150 Z" fill="#9E9E9E" stroke="#333" stroke-width="2" class="sector" data-sector="west"/>
                <text x="100" y="250" text-anchor="middle" font-size="24" font-weight="bold" fill="white">West</text>
                
                <!-- Northwest -->
                <path d="M 250,250 L 50,150 L 150,50 Z" fill="#BDBDBD" stroke="#333" stroke-width="2" class="sector" data-sector="northwest"/>
                <text x="125" y="125" text-anchor="middle" font-size="18" font-weight="bold" fill="#333" transform="rotate(-45 125 125)">Northwest</text>
                
                <!-- Center circle -->
                <circle cx="250" cy="250" r="80" fill="white" stroke="#333" stroke-width="2"/>
                
                <!-- Bagua labels -->
                <!-- North -->
                <text x="250" y="140" text-anchor="middle" font-size="14" fill="#333">Water</text>
                <text x="250" y="155" text-anchor="middle" font-size="12" fill="#666">Career</text>
                
                <!-- Northeast -->
                <text x="350" y="150" text-anchor="middle" font-size="14" fill="#333" transform="rotate(45 350 150)">Earth</text>
                <text x="350" y="165" text-anchor="middle" font-size="12" fill="#666" transform="rotate(45 350 165)">Education</text>
                
                <!-- East -->
                <text x="400" y="270" text-anchor="middle" font-size="14" fill="#333">Wood</text>
                <text x="400" y="285" text-anchor="middle" font-size="12" fill="#666">Health</text>
                
                <!-- Southeast -->
                <text x="350" y="350" text-anchor="middle" font-size="14" fill="#333" transform="rotate(-45 350 350)">Wood</text>
                <text x="350" y="365" text-anchor="middle" font-size="12" fill="#666" transform="rotate(-45 350 365)">Money</text>
                
                <!-- South -->
                <text x="250" y="360" text-anchor="middle" font-size="14" fill="#333">Fire</text>
                <text x="250" y="375" text-anchor="middle" font-size="12" fill="#666">Fame</text>
                
                <!-- Southwest -->
                <text x="150" y="350" text-anchor="middle" font-size="14" fill="#333" transform="rotate(45 150 350)">Earth</text>
                <text x="150" y="365" text-anchor="middle" font-size="12" fill="#666" transform="rotate(45 150 365)">Relationships</text>
                
                <!-- West -->
                <text x="100" y="270" text-anchor="middle" font-size="14" fill="#333">Metal</text>
                <text x="100" y="285" text-anchor="middle" font-size="12" fill="#666">Children</text>
                
                <!-- Northwest -->
                <text x="150" y="150" text-anchor="middle" font-size="14" fill="#333" transform="rotate(-45 150 150)">Metal</text>
                <text x="150" y="165" text-anchor="middle" font-size="12" fill="#666" transform="rotate(-45 150 165)">Mentors</text>
                
                <!-- Trigram symbols (simplified representation) -->
                <g transform="translate(240,70)">
                    <rect x="0" y="0" width="20" height="3" fill="#333"/>
                    <rect x="0" y="5" width="20" height="3" fill="#333"/>
                    <rect x="0" y="10" width="8" height="3" fill="#333"/>
                    <rect x="12" y="10" width="8" height="3" fill="#333"/>
                </g>
            </svg>
            
            <div class="center-arrow"></div>
        </div>

        <div class="sector-info" id="sector-info">
            <h2>Click on a sector to see feng shui cures and recommendations</h2>
        </div>
    </div>

    <script>
        let compassHeading = 0;
        let baguaRotation = 0;

        const sectorData = {
            north: {
                name: "North - Water Element",
                area: "Career & Life Path",
                element: "Water",
                colors: ["Black", "Dark Blue", "Navy"],
                trigram: "Kan",
                cures: [
                    "Add water features like fountains or aquariums",
                    "Use black or dark blue decor",
                    "Place metal objects to strengthen water element",
                    "Display images of water scenes",
                    "Add wavy or curved shapes",
                    "Use mirrors to represent water",
                    "Keep this area clean and clutter-free",
                    "Add career-related symbols or awards"
                ]
            },
            northeast: {
                name: "Northeast - Earth Element",
                area: "Knowledge & Education",
                element: "Earth",
                colors: ["Beige", "Light Yellow", "Sandy"],
                trigram: "Gen",
                cures: [
                    "Place crystals or stones",
                    "Add ceramic or pottery items",
                    "Use earth tone colors",
                    "Create a study or meditation area",
                    "Display books and educational materials",
                    "Add mountain imagery",
                    "Use square shapes and patterns",
                    "Place a desk or reading chair here"
                ]
            },
            east: {
                name: "East - Wood Element",
                area: "Family & Health",
                element: "Wood",
                colors: ["Green", "Brown"],
                trigram: "Zhen",
                cures: [
                    "Add healthy plants or flowers",
                    "Use wooden furniture or decor",
                    "Display family photos in wooden frames",
                    "Use green and brown colors",
                    "Add water features to nourish wood",
                    "Place bamboo or lucky bamboo",
                    "Use rectangular shapes",
                    "Keep this area vibrant and alive"
                ]
            },
            southeast: {
                name: "Southeast - Wood Element",
                area: "Wealth & Prosperity",
                element: "Wood",
                colors: ["Green", "Purple", "Gold"],
                trigram: "Xun",
                cures: [
                    "Place a money tree or jade plant",
                    "Add a small fountain (flowing inward)",
                    "Use purple, gold, or green accents",
                    "Display symbols of abundance",
                    "Keep a bowl of coins or crystals",
                    "Add wind chimes for energy flow",
                    "Place valuable items here",
                    "Ensure good lighting in this area"
                ]
            },
            south: {
                name: "South - Fire Element",
                area: "Fame & Recognition",
                element: "Fire",
                colors: ["Red", "Orange", "Purple"],
                trigram: "Li",
                cures: [
                    "Add candles or bright lighting",
                    "Use red or orange decor",
                    "Display awards and certificates",
                    "Add triangular or pointed shapes",
                    "Place red flowers or artwork",
                    "Use wood elements to feed fire",
                    "Display your achievements",
                    "Add a fireplace or red lamp"
                ]
            },
            southwest: {
                name: "Southwest - Earth Element",
                area: "Love & Relationships",
                element: "Earth",
                colors: ["Pink", "Red", "White"],
                trigram: "Kun",
                cures: [
                    "Use pairs of objects (2 candles, 2 pillows)",
                    "Add rose quartz or pink crystals",
                    "Display romantic artwork or photos",
                    "Use pink, red, or earth tones",
                    "Place fresh flowers (especially peonies)",
                    "Add ceramic or pottery pairs",
                    "Create a cozy seating area for two",
                    "Remove single or solitary items"
                ]
            },
            west: {
                name: "West - Metal Element",
                area: "Children & Creativity",
                element: "Metal",
                colors: ["White", "Gray", "Metallic"],
                trigram: "Dui",
                cures: [
                    "Add metal decor or sculptures",
                    "Use white or metallic colors",
                    "Display children's artwork or photos",
                    "Create a creative workspace",
                    "Add round or circular shapes",
                    "Place bells or chimes",
                    "Use earth elements to support metal",
                    "Keep playful or whimsical items"
                ]
            },
            northwest: {
                name: "Northwest - Metal Element",
                area: "Helpful People & Travel",
                element: "Metal",
                colors: ["White", "Gray", "Black"],
                trigram: "Qian",
                cures: [
                    "Add metal objects or decor",
                    "Display travel photos or maps",
                    "Use white, gray, or metallic colors",
                    "Place religious or spiritual items",
                    "Add images of mentors or guides",
                    "Use circular or dome shapes",
                    "Keep a gratitude journal here",
                    "Display globe or travel souvenirs"
                ]
            }
        };

        function updateCompass(heading) {
            compassHeading = heading;
            document.getElementById('compass-reading').textContent = Math.round(heading);
            
            // Determine facing direction
            let facingDirection = '';
            if (heading >= 337.5 || heading < 22.5) facingDirection = 'North';
            else if (heading >= 22.5 && heading < 67.5) facingDirection = 'Northeast';
            else if (heading >= 67.5 && heading < 112.5) facingDirection = 'East';
            else if (heading >= 112.5 && heading < 157.5) facingDirection = 'Southeast';
            else if (heading >= 157.5 && heading < 202.5) facingDirection = 'South';
            else if (heading >= 202.5 && heading < 247.5) facingDirection = 'Southwest';
            else if (heading >= 247.5 && heading < 292.5) facingDirection = 'West';
            else if (heading >= 292.5 && heading < 337.5) facingDirection = 'Northwest';
            
            document.getElementById('facing-direction').textContent = facingDirection;
            
            // Rotate bagua map
            baguaRotation = -heading;
            document.getElementById('bagua').style.transform = `rotate(${baguaRotation}deg)`;
        }

        function showSectorInfo(sector) {
            const data = sectorData[sector];
            if (!data) return;
            
            const infoDiv = document.getElementById('sector-info');
            infoDiv.innerHTML = `
                <h2>${data.name}</h2>
                <p><strong>Life Area:</strong> ${data.area}</p>
                <p><strong>Element:</strong> ${data.element}</p>
                <p><strong>Colors:</strong> ${data.colors.join(', ')}</p>
                <p><strong>Trigram:</strong> ${data.trigram}</p>
                <h3>Feng Shui Cures & Enhancements:</h3>
                <ul class="cure-list">
                    ${data.cures.map(cure => `<li>${cure}</li>`).join('')}
                </ul>
            `;
        }

        // Initialize compass
        if ('DeviceOrientationEvent' in window) {
            window.addEventListener('deviceorientationabsolute', function(event) {
                if (event.absolute && event.alpha !== null) {
                    updateCompass(event.alpha);
                    document.getElementById('status').textContent = 'Compass active - point your device to see the bagua orientation';
                    document.getElementById('status').className = '';
                }
            });
            
            // Fallback for iOS
            window.addEventListener('deviceorientation', function(event) {
                if (event.webkitCompassHeading !== undefined) {
                    updateCompass(event.webkitCompassHeading);
                    document.getElementById('status').textContent = 'Compass active - point your device to see the bagua orientation';
                    document.getElementById('status').className = '';
                } else if (event.alpha !== null) {
                    updateCompass(event.alpha);
                    document.getElementById('status').textContent = 'Compass active - point your device to see the bagua orientation';
                    document.getElementById('status').className = '';
                }
            });
            
            // Request permission for iOS 13+
            if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                document.getElementById('status').innerHTML = '<button onclick="requestCompassPermission()">Enable Compass</button>';
            }
        } else {
            document.getElementById('status').textContent = 'Compass not supported on this device';
            document.getElementById('status').className = 'error';
        }

        function requestCompassPermission() {
            DeviceOrientationEvent.requestPermission()
                .then(response => {
                    if (response == 'granted') {
                        document.getElementById('status').textContent = 'Compass active - point your device to see the bagua orientation';
                        document.getElementById('status').className = '';
                    } else {
                        document.getElementById('status').textContent = 'Compass permission denied';
                        document.getElementById('status').className = 'error';
                    }
                })
                .catch(console.error);
        }

        // Add click handlers to sectors
        document.querySelectorAll('.sector').forEach(sector => {
            sector.addEventListener('click', function() {
                showSectorInfo(this.getAttribute('data-sector'));
            });
            
            // Add hover effect
            sector.style.cursor = 'pointer';
            sector.addEventListener('mouseenter', function() {
                this.style.opacity = '0.8';
            });
            sector.addEventListener('mouseleave', function() {
                this.style.opacity = '1';
            });
        });

        // Manual rotation for testing on desktop
        if (!'ontouchstart' in window) {
            document.getElementById('status').innerHTML += '<br><br>Desktop mode: <input type="range" min="0" max="360" value="0" oninput="updateCompass(this.value)"> <span id="manual-angle">0</span>Â°';
        }
    </script>
</body>
</html>