<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lo Pan Bagua Feng Shui Map</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            width: 100%;
            text-align: center;
        }

        h1 {
            color: #8B4513;
            margin-bottom: 20px;
        }

        .compass-container {
            position: relative;
            width: 500px;
            height: 500px;
            margin: 0 auto 30px;
        }

        #bagua {
            width: 100%;
            height: 100%;
            transition: transform 0.3s ease;
        }

        .center-arrow {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 40px solid rgba(255,255,255,0.9);
            z-index: 10;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .compass-info {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .sector-info {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: left;
            margin-top: 20px;
        }

        .sector-info h2 {
            color: #8B4513;
            margin-top: 0;
        }

        .cure-list {
            list-style-type: disc;
            padding-left: 20px;
        }

        .error {
            color: #d32f2f;
            padding: 10px;
            background: #ffebee;
            border-radius: 4px;
            margin: 10px 0;
        }

        .loading {
            color: #666;
        }

        #lockButton {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px 0;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        #lockButton.locked {
            background-color: #f44336;
        }

        #lockButton:hover {
            opacity: 0.9;
        }

        .lock-reminder {
            display: none;
            color: #ff9800;
            font-size: 14px;
            margin-top: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        @media (max-width: 600px) {
            .compass-container {
                width: 350px;
                height: 350px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Lo Pan Bagua Feng Shui Map</h1>

        <div class="compass-info">
            <p class="loading" id="status">Initializing compass...</p>
            <p><strong>Compass Direction:</strong> <span id="compass-reading">--</span>°</p>
            <p><strong>Facing Direction:</strong> <span id="facing-direction">--</span></p>
            <button id="lockButton" onclick="toggleLock()">Lock Zone</button>
            <p class="lock-reminder" id="lockReminder">⚠️ Remember to unlock the compass to continue exploring other directions</p>
        </div>

        <div class="compass-container">
            <img id="bagua" src="https://i.imgur.com/U7rSJVZ.png" alt="Bagua Map">
            <div class="center-arrow"></div>
        </div>

        <div class="sector-info" id="sector-info">
            <h2>Point your device to a direction to see specific feng shui recommendations</h2>
        </div>
    </div>

    <script>
        let isLocked = false;
        let reminderTimeout = null;

        const sectorData = {
            'North': {
                element: 'Water',
                area: 'Career & Life Path',
                cures: [
                    'Add water features like fountains or aquariums',
                    'Use black or dark blue decor',
                    'Display images of water scenes',
                    'Add wavy or curved shapes',
                    'Use mirrors to represent water',
                    'Keep this area clean and clutter-free',
                    'Add career-related symbols or awards',
                    'Include metal elements (white, gray, metallic colors) as Metal nourishes Water in the productive cycle'
                ]
            },
            'Northeast': {
                element: 'Earth',
                area: 'Knowledge & Education',
                cures: [
                    'Place crystals or stones',
                    'Add ceramic or pottery items',
                    'Use earth tone colors (beige, yellow, brown)',
                    'Create a study or meditation area',
                    'Display books and educational materials',
                    'Add mountain imagery',
                    'Use square shapes and patterns',
                    'Include fire elements (candles, red accents) as Fire nourishes Earth in the productive cycle'
                ]
            },
            'East': {
                element: 'Wood',
                area: 'Family & Health',
                cures: [
                    'Add healthy plants or flowers',
                    'Use wooden furniture or decor',
                    'Display family photos in wooden frames',
                    'Use green and brown colors',
                    'Place bamboo or lucky bamboo',
                    'Use rectangular shapes',
                    'Keep this area vibrant and alive',
                    'Include water elements (fountains, blue colors) as Water nourishes Wood in the productive cycle'
                ]
            },
            'Southeast': {
                element: 'Wood',
                area: 'Wealth & Prosperity',
                cures: [
                    'Place a money tree or jade plant',
                    'Add a small fountain (flowing inward)',
                    'Use purple, gold, or green accents',
                    'Display symbols of abundance',
                    'Keep a bowl of coins or crystals',
                    'Add wind chimes for energy flow',
                    'Ensure good lighting in this area',
                    'Include water elements (aquarium, water imagery) as Water nourishes Wood in the productive cycle'
                ]
            },
            'South': {
                element: 'Fire',
                area: 'Fame & Recognition',
                cures: [
                    'Add candles or bright lighting',
                    'Use red or orange decor',
                    'Display awards and certificates',
                    'Add triangular or pointed shapes',
                    'Place red flowers or artwork',
                    'Display your achievements',
                    'Add a fireplace or red lamp',
                    'Include wood elements (plants, green colors) as Wood nourishes Fire in the productive cycle'
                ]
            },
            'Southwest': {
                element: 'Earth',
                area: 'Love & Relationships',
                cures: [
                    'Use pairs of objects (2 candles, 2 pillows)',
                    'Add rose quartz or pink crystals',
                    'Display romantic artwork or photos',
                    'Use pink, red, or earth tones',
                    'Place fresh flowers (especially peonies)',
                    'Add ceramic or pottery pairs',
                    'Create a cozy seating area for two',
                    'Include fire elements (candles, pink/red colors) as Fire nourishes Earth in the productive cycle'
                ]
            },
            'West': {
                element: 'Metal',
                area: 'Children & Creativity',
                cures: [
                    'Add metal decor or sculptures',
                    'Use white or metallic colors',
                    'Display children\'s artwork or photos',
                    'Create a creative workspace',
                    'Add round or circular shapes',
                    'Place bells or chimes',
                    'Keep playful or whimsical items',
                    'Include earth elements (crystals, yellow colors) as Earth nourishes Metal in the productive cycle'
                ]
            },
            'Northwest': {
                element: 'Metal',
                area: 'Helpful People & Travel',
                cures: [
                    'Add metal objects or decor',
                    'Display travel photos or maps',
                    'Use white, gray, or metallic colors',
                    'Place religious or spiritual items',
                    'Add images of mentors or guides',
                    'Use circular or dome shapes',
                    'Display globe or travel souvenirs',
                    'Include earth elements (stones, ceramic items) as Earth nourishes Metal in the productive cycle'
                ]
            }
        };

        function toggleLock() {
            isLocked = !isLocked;
            const lockButton = document.getElementById('lockButton');
            const lockReminder = document.getElementById('lockReminder');
            
            if (isLocked) {
                lockButton.textContent = 'Locked Zone';
                lockButton.classList.add('locked');
                
                // Show reminder after 30 seconds
                reminderTimeout = setTimeout(() => {
                    lockReminder.style.display = 'block';
                }, 30000);
            } else {
                lockButton.textContent = 'Lock Zone';
                lockButton.classList.remove('locked');
                lockReminder.style.display = 'none';
                
                // Clear the timeout
                if (reminderTimeout) {
                    clearTimeout(reminderTimeout);
                    reminderTimeout = null;
                }
            }
        }

        function updateSectorInfo(direction) {
            const data = sectorData[direction];
            if (!data) return;
            
            const infoDiv = document.getElementById('sector-info');
            infoDiv.innerHTML = `
                <h2>${direction} - ${data.element} Element</h2>
                <h3>${data.area}</h3>
                <ul class="cure-list">
                    ${data.cures.map(cure => `<li>${cure}</li>`).join('')}
                </ul>
            `;
        }

        function updateCompass(heading) {
            document.getElementById('compass-reading').textContent = Math.round(heading);
            
            let facingDirection = '';
            if (heading >= 337.5 || heading < 22.5) facingDirection = 'North';
            else if (heading >= 22.5 && heading < 67.5) facingDirection = 'Northeast';
            else if (heading >= 67.5 && heading < 112.5) facingDirection = 'East';
            else if (heading >= 112.5 && heading < 157.5) facingDirection = 'Southeast';
            else if (heading >= 157.5 && heading < 202.5) facingDirection = 'South';
            else if (heading >= 202.5 && heading < 247.5) facingDirection = 'Southwest';
            else if (heading >= 247.5 && heading < 292.5) facingDirection = 'West';
            else if (heading >= 292.5 && heading < 337.5) facingDirection = 'Northwest';
            
            document.getElementById('facing-direction').textContent = facingDirection;
            
            // Only rotate if not locked
            if (!isLocked) {
                document.getElementById('bagua').style.transform = `rotate(${-heading}deg)`;
            }
            
            // Update sector info based on current direction
            updateSectorInfo(facingDirection);
        }

        if ('DeviceOrientationEvent' in window) {
            window.addEventListener('deviceorientationabsolute', function(event) {
                if (event.absolute && event.alpha !== null) {
                    updateCompass(event.alpha);
                    document.getElementById('status').textContent = 'Compass active';
                    document.getElementById('status').className = '';
                }
            });
            
            window.addEventListener('deviceorientation', function(event) {
                if (event.webkitCompassHeading !== undefined) {
                    updateCompass(event.webkitCompassHeading);
                    document.getElementById('status').textContent = 'Compass active';
                    document.getElementById('status').className = '';
                } else if (event.alpha !== null) {
                    updateCompass(event.alpha);
                    document.getElementById('status').textContent = 'Compass active';
                    document.getElementById('status').className = '';
                }
            });
            
            if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                document.getElementById('status').innerHTML = '<button onclick="requestCompassPermission()">Enable Compass</button>';
            }
        } else {
            document.getElementById('status').textContent = 'Compass not supported';
            document.getElementById('status').className = 'error';
        }

        function requestCompassPermission() {
            DeviceOrientationEvent.requestPermission()
                .then(response => {
                    if (response == 'granted') {
                        document.getElementById('status').textContent = 'Compass active';
                        document.getElementById('status').className = '';
                    } else {
                        document.getElementById('status').textContent = 'Compass permission denied';
                        document.getElementById('status').className = 'error';
                    }
                })
                .catch(console.error);
        }

        if (!'ontouchstart' in window) {
            document.getElementById('status').innerHTML += '<br><br>Desktop: <input type="range" min="0" max="360" value="0" oninput="updateCompass(this.value)">';
        }
    </script>
</body>
</html>